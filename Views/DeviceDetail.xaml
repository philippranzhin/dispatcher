<UserControl x:Class="DispatcherDesktop.Views.DeviceDetail"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:DispatcherDesktop.Views"
             xmlns:mvvm="http://prismlibrary.com/"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:navigation="clr-namespace:DispatcherDesktop.Navigation"
             mc:Ignorable="d" 
             mvvm:ViewModelLocator.AutoWireViewModel="True"
             d:DesignHeight="150" d:DesignWidth="200">
    <materialDesign:DialogHost
        DialogClosing="DialogHost_OnDialogClosing">
        <materialDesign:DialogHost.DialogContent>
            <ContentControl
                             mvvm:RegionManager.RegionName="{x:Static navigation:RegionNames.AddRegister}"
                             mvvm:RegionManager.RegionContext="{Binding Device}"/>
        </materialDesign:DialogHost.DialogContent>
        <DockPanel VerticalAlignment="Stretch">
        <DockPanel>
                <DockPanel DockPanel.Dock="Top">
                    <Button
                    Command="{x:Static materialDesign:DialogHost.OpenDialogCommand}"
                    DockPanel.Dock="Right"
                    Style="{StaticResource MaterialDesignFloatingActionMiniLightButton}"
                    HorizontalAlignment="Right"
                    Margin="15"
                    ToolTip="Добавить регистр">
                        <materialDesign:PackIcon
                        Kind="Add"
                        Height="24"
                        Width="24" />
                    </Button>
                    <TextBlock DockPanel.Dock="Left" 
                           VerticalAlignment="Center" 
                           Margin="5"
                           Style="{DynamicResource MaterialDesignTitleTextBlock}">
                    <Run>Информация об устройстве</Run> 
                    <Run Foreground="{DynamicResource SecondaryAccentBrush}" Text="{Binding Device.Name, Mode=OneWay}"/>
                    </TextBlock>
                </DockPanel>
                <ItemsControl 
                ItemsSource="{Binding Registers}"
                DockPanel.Dock="Top">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <materialDesign:Card Width="200" Height="150" Margin="15" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                            <DockPanel>
                                <materialDesign:ColorZone DockPanel.Dock="Top" Padding="10">
                                    <DockPanel>
                                        <materialDesign:PopupBox DockPanel.Dock="Right" PlacementMode="BottomAndAlignRightEdges">
                                            <ListBox>
                                                    <ListBoxItem Selected="ListBoxItem_OnSelected" DataContext="{Binding Description}">удалить</ListBoxItem>
                                                    <ListBoxItem>изменить значение</ListBoxItem>
                                            </ListBox>
                                        </materialDesign:PopupBox>
                                        <TextBlock 
                                            DockPanel.Dock="Left" 
                                            TextWrapping="WrapWithOverflow" 
                                            Style="{DynamicResource MaterialDesignSubheadingTextBlock}" 
                                            LineStackingStrategy="MaxHeight" Text="{Binding Description.Name}"/> 
                                    </DockPanel>
                                </materialDesign:ColorZone>
                                <TextBlock DockPanel.Dock="Bottom" 
                                           TextWrapping="WrapWithOverflow" 
                                           Style="{DynamicResource MaterialDesignBody1TextBlock}" 
                                           Foreground="{DynamicResource PrimaryHueDarkBrush}"
                                           Padding="2"
                                           HorizontalAlignment="Right"
                                           LineStackingStrategy="MaxHeight" 
                                           Text="{Binding Data.SaveDate}"
                                />
                                <TextBlock DockPanel.Dock="Top" Style="{DynamicResource MaterialDesignTitleTextBlock}" Padding="10" Margin="5">
                                    <Run Text="{Binding Data.Value, Mode=OneWay}" Foreground="{DynamicResource SecondaryAccentBrush}"/> <Run Text="{Binding Description.Postfix, Mode=OneWay}"/>
                                </TextBlock>
                                    <TextBlock DockPanel.Dock="Top"  Style="{DynamicResource MaterialDesignCaptionTextBlock}" Padding="10 0 10 0" TextWrapping="WrapWithOverflow" Text="{Binding Description.Description}"/>
                            </DockPanel>
                        </materialDesign:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </DockPanel>
    </DockPanel>
    </materialDesign:DialogHost>
</UserControl>
